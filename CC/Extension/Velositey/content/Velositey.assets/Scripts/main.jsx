#target photoshopvar docRef = app.activeDocument;var origName = decodeURI(activeDocument.name);function main(){    removeDuplicateLayers();    app.open(newFile);    //app.activeDocument.activeLayer  = app.activeDocument.layerSets.getByName(elementName);     app.activeDocument.activeLayer  = app.activeDocument.layerSets[elementIndex];     dupLayers(origName);    app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);}function dupLayers(aDoc) {  function cTID(s) { return app.charIDToTypeID(s); };    var desc153 = new ActionDescriptor();        var ref61 = new ActionReference();        ref61.putEnumerated( cTID('Lyr '), cTID('Ordn'), cTID('Trgt') );    desc153.putReference( cTID('null'), ref61 );        var ref62 = new ActionReference();        ref62.putName( cTID('Dcmn'), aDoc );    desc153.putReference( cTID('T   '), ref62 );    desc153.putInteger( cTID('Vrsn'), 2 );    executeAction( cTID('Dplc'), desc153, DialogModes.NO );};function removeDuplicateLayers(){    dummyLayer();    var layersToRemove = new Array();    for(i=0; i < docRef.layers.length; i++){        if(docRef.layers[i].name==elementName)        {            layersToRemove.push(docRef.layers[i]);        }    }    for(i=layersToRemove.length-1; 0 <=i; i--){        layersToRemove[i].remove();    }}function dummyLayer(){    //This function is to get around the LayerSet not being     //deleted if it's index was 0 (top layer)        //Creates a new layer    var idMk = charIDToTypeID( "Mk  " );        var desc294 = new ActionDescriptor();        var idnull = charIDToTypeID( "null" );            var ref299 = new ActionReference();            var idLyr = charIDToTypeID( "Lyr " );            ref299.putClass( idLyr );        desc294.putReference( idnull, ref299 );    executeAction( idMk, desc294, DialogModes.NO );    //Names the layer to elementName    var idsetd = charIDToTypeID( "setd" );        var desc295 = new ActionDescriptor();        var idnull = charIDToTypeID( "null" );            var ref300 = new ActionReference();            var idLyr = charIDToTypeID( "Lyr " );            var idOrdn = charIDToTypeID( "Ordn" );            var idTrgt = charIDToTypeID( "Trgt" );            ref300.putEnumerated( idLyr, idOrdn, idTrgt );        desc295.putReference( idnull, ref300 );        var idT = charIDToTypeID( "T   " );            var desc296 = new ActionDescriptor();            var idNm = charIDToTypeID( "Nm  " );            desc296.putString( idNm, elementName);        var idLyr = charIDToTypeID( "Lyr " );        desc295.putObject( idT, idLyr, desc296 );    executeAction( idsetd, desc295, DialogModes.NO ); }