var docRef = app.activeDocument;var doc = app.activeDocument;var activeLay = docRef.activeLayer;var activeLayIndex = docRef.activeLayer.index;var textColorWhite = new SolidColor;textColorWhite.rgb.red = 255;textColorWhite.rgb.green = 255;textColorWhite.rgb.blue = 255;var textCounterXXX = 0;var fontInfoArray = new Array();for(var j = 0; j < docRef.layerSets.length; j++){    if(activeDocument.layerSets[j].name == "Dimensions"){        var dimensionsLS = docRef.layerSets.Dimensions.layerSets;        for(var i = 0; i < dimensionsLS.length; i++) {            for(var j = 0; j < dimensionsLS.length; j++) {                if(dimensionsLS[i].name == "Font Info " + j){                    fontInfoArray.push(j);                }            }        }    }}fontInfoArray.sort(function(a,b){return a-b});outerloop:for(var k = 0; k < fontInfoArray.length; k++){    if(k != fontInfoArray[k]){        textCounterXXX = k;        break outerloop;    }else{        textCounterXXX = fontInfoArray.length;    }}docRef.activeLayer.index = activeLayIndex;var fontName = activeLay.textItem.font;var fontSize = activeLay.textItem.size;var fontColour = activeLay.textItem.color.rgb.hexValue;var fontJust = "";try {    if (activeLay.textItem.justification == Justification.LEFT){        fontJust = "Left";    }else if (activeLay.textItem.justification == Justification.CENTER){        fontJust = "Centre";    }else if (activeLay.textItem.justification == Justification.RIGHT){        fontJust = "Right";    }    }catch(e){    fontJust = "Left";}var activeB0 = activeLay.bounds[0].value;var activeB1 = activeLay.bounds[1].value;var activeB2 = activeLay.bounds[2].value;var activeB3 = activeLay.bounds[3].value;var firstBoxB0 = activeB0-30;var firstBoxB1 = activeB1;var firstBoxB2 = firstBoxB0+20;var firstBoxB3 = firstBoxB1+20;var secondBoxB0 = 30;var secondBoxB1 = firstBoxB1;var secondBoxB2 = 50;var secondBoxB3 = firstBoxB3;try{    mainLayerSet = app.activeDocument.layerSets.getByName("Dimensions");}catch (error){    mainLayerSet = app.activeDocument.layerSets.add();    mainLayerSet.name = "Dimensions";}layerSetRef = mainLayerSet.layerSets.add();layerSetRef.name = "Font Info " + textCounterXXX;layerSetFirstBox = layerSetRef.layerSets.add();layerSetFirstBox.name = "Ref " + textCounterXXX;DrawShape([firstBoxB0,firstBoxB1],[firstBoxB2,firstBoxB1],[firstBoxB2,firstBoxB3],[firstBoxB0,firstBoxB3]);docRef.activeLayer.name = "Ref Box";var firstBoxText= layerSetFirstBox.artLayers.add();firstBoxText.kind = LayerKind.TEXT;firstBoxText.textItem.kind = TextType.PARAGRAPHTEXT ; firstBoxText.textItem.width = 20;firstBoxText.textItem.height = 20;firstBoxText.textItem.contents = textCounterXXX;firstBoxText.textItem.position = Array(firstBoxB0,firstBoxB1);firstBoxText.textItem.size =12;firstBoxText.textItem.color = textColorWhite;firstBoxText.textItem.justification = Justification.CENTER;firstBoxText.textItem.baselineShift = -5;layerSetSecondBox = layerSetRef.layerSets.add();layerSetSecondBox.name = "Info " + textCounterXXX;DrawShape([secondBoxB0,secondBoxB1],[(secondBoxB2+190),secondBoxB1],[(secondBoxB2+190),(secondBoxB3+52)],[(secondBoxB0+20),(secondBoxB3+52)],[(secondBoxB0+20),secondBoxB3],[secondBoxB0,secondBoxB3]);docRef.activeLayer.name = "Info Box";var secondBoxText= layerSetSecondBox.artLayers.add();secondBoxText.kind = LayerKind.TEXT;secondBoxText.textItem.kind = TextType.PARAGRAPHTEXT ; secondBoxText.textItem.width = 20;secondBoxText.textItem.height = 20;secondBoxText.textItem.contents = textCounterXXX;secondBoxText.textItem.position = Array(secondBoxB0,secondBoxB1);secondBoxText.textItem.size =12;secondBoxText.textItem.color = textColorWhite;secondBoxText.textItem.justification = Justification.CENTER;secondBoxText.textItem.baselineShift = -5;var fontInfoBox= layerSetSecondBox.artLayers.add();fontInfoBox.kind = LayerKind.TEXT;fontInfoBox.textItem.kind = TextType.PARAGRAPHTEXT ; fontInfoBox.textItem.width = 210;fontInfoBox.textItem.height = 60;fontInfoBox.textItem.contents = "Font:\t" + fontName + "\r" + "Size:\t" + fontSize + "\r" + "Hex:\t#" + fontColour + "\r" + "Just.:\t" + fontJust;fontInfoBox.textItem.position = Array(secondBoxB0+30,secondBoxB1+10);fontInfoBox.textItem.size =12;fontInfoBox.textItem.color = textColorWhite;fontInfoBox.textItem.justification = Justification.LEFT;fontInfoBox.textItem.baselineShift = 0;function DrawShape() {        var doc = app.activeDocument;    var y = arguments.length;    var i = 0;        var lineArray = [];    for (i = 0; i < y; i++) {        lineArray[i] = new PathPointInfo;        lineArray[i].kind = PointKind.CORNERPOINT;        lineArray[i].anchor = arguments[i];        lineArray[i].leftDirection = lineArray[i].anchor;        lineArray[i].rightDirection = lineArray[i].anchor;    }     var lineSubPathArray = new SubPathInfo();    lineSubPathArray.closed = true;    lineSubPathArray.operation = ShapeOperation.SHAPEADD;    lineSubPathArray.entireSubPath = lineArray;    var myPathItem = doc.pathItems.add("myPath", [lineSubPathArray]);         var desc88 = new ActionDescriptor();    var ref60 = new ActionReference();    ref60.putClass(stringIDToTypeID("contentLayer"));    desc88.putReference(charIDToTypeID("null"), ref60);    var desc89 = new ActionDescriptor();    var desc90 = new ActionDescriptor();    var desc91 = new ActionDescriptor();    desc91.putDouble(charIDToTypeID("Rd  "), 255); // R    desc91.putDouble(charIDToTypeID("Grn "), 0); // G    desc91.putDouble(charIDToTypeID("Bl  "), 0); // B    var id481 = charIDToTypeID("RGBC");    desc90.putObject(charIDToTypeID("Clr "), id481, desc91);    desc89.putObject(charIDToTypeID("Type"), stringIDToTypeID("solidColorLayer"), desc90);    desc88.putObject(charIDToTypeID("Usng"), stringIDToTypeID("contentLayer"), desc89);    executeAction(charIDToTypeID("Mk  "), desc88, DialogModes.NO);        myPathItem.remove();}